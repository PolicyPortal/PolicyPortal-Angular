
<!-- View Policies Component Template - Converted to Bootstrap -->
  <h2 class="heading mb-2">Policies History</h2>
  

<!-- Filter Section - Styled with Bootstrap Card -->
      <div class="card shadow-sm rounded-3 border-0 p-4 mb-2">
        <form [formGroup]="filterForm" (ngSubmit)="applyFilters()">
          <div class="row g-3">
            <!-- From Date -->
            <div class="col-lg-3 col-md-6">
              <label class="form-label small" for="fromDate">From Date</label>
              <input formControlName="fromDate" id="fromDate" class="form-control" type="text" placeholder="Select Date..." onfocus="this.type='date'" onblur="if(!this.value)this.type='text'">
            </div>
            <!-- To Date -->
            <div class="col-lg-3 col-md-6">
              <label class="form-label small" for="toDate">To Date</label>
              <input formControlName="toDate" id="toDate" class="form-control" type="text" placeholder="Select Date..." onfocus="this.type='date'" onblur="if(!this.value)this.type='text'">
            </div>
            <!-- Policy No. -->
            <div class="col-lg-3 col-md-6">
              <label class="form-label small" for="policyNo">Insurance Policy No.</label>
              <input formControlName="policyNo" placeholder="Search..." id="policyNo" type="text" class="form-control">
            </div>
            <!-- Chassis No. -->
            <div class="col-lg-3 col-md-6">
              <label class="form-label small" for="chassisNo">Chassis No.</label>
              <input formControlName="chassisNo" placeholder="Search..." id="chassisNo" type="text" class="form-control">
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="d-flex justify-content-end gap-2 mt-4">
            <button class="btn btn-outline-secondary px-4" type="button" (click)="resetFilters()">
              Reset
            </button>
            <button class="btn btn-primary px-4 d-flex align-items-center gap-2" type="submit">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
              </svg>
              Search
            </button>
          </div>
        </form>
      </div>

      <!-- Table Container - Converted to Bootstrap Table -->
      <div class="card shadow-sm rounded-3 border-0 overflow-hidden">
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0" style="font-size: 0.9rem;">
            <thead class="table-light">
              <tr>
                <!-- Generating all headers from your list -->
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">UID</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Status</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Policy No.</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Date</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Time</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Insurer</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Risk Start Date</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Policy Holder</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Engine No.</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Chassis No.</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Vehicle</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Body Type</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Policy Type</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">New Vehicle</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">IDV</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Premium</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">Dealership</th>
                <th class="p-3 text-start text-uppercase small fw-semibold text-muted text-nowrap">View</th>
              </tr>
            </thead>
            <tbody>
              @for (policy of paginatedPolicies(); track policy.uid) {
                <tr class="border-top">
                  <td class="p-3 text-nowrap">
                    <span class="status-badge badge rounded-pill px-3 py-2 small fw-medium text-bg-info-subtle border border-info-subtle">
                    {{ policy.uid }}
                    </span>
                </td>
                  <td class="p-3 text-nowrap">
                    <!-- Bootstrap 5.3+ subtle badges -->
                    <span class="status-badge badge rounded-pill px-3 py-2 small fw-medium "
                          [class]="getStatusClass(policy.status)">
                      {{ policy.status }}
                    </span>
                  </td>
                  <td class="p-3 text-nowrap fw-medium">{{ policy.policyNo }}</td>
                  <td class="p-3 text-nowrap">{{ policy.date }}</td>
                  <td class="p-3 text-nowrap">{{ policy.time }}</td>
                  <td class="p-3 text-nowrap">{{ policy.insurer }}</td>
                  <td class="p-3 text-nowrap">{{ policy.riskStartDate }}</td>
                  <td class="p-3 text-nowrap">{{ policy.holderName }}</td>
                  <td class="p-3 text-nowrap">{{ policy.engineNo }}</td>
                  <td class="p-3 text-nowrap">{{ policy.chassisNo }}</td>
                  <td class="p-3 text-nowrap">{{ policy.vehicle }}</td>
                  <td class="p-3 text-nowrap">{{ policy.bodyType }}</td>
                  <td class="p-3 text-nowrap">{{ policy.policyType }}</td>
                  <td class="p-3 text-nowrap">{{ policy.newVehicle }}</td>
                  <td class="p-3 text-nowrap fw-medium">{{ policy.idv }}</td>
                  <td class="p-3 text-nowrap fw-medium">{{ policy.premium }}</td>
                  <td class="p-3 text-nowrap">{{ policy.dealership }}</td>
                  <td class="p-3 text-nowrap">
                    <button class="btn btn-link btn-sm p-0 text-primary">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
                        <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/>
                        <path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
                      </svg>
                    </button>
                  </td>
                </tr>
              }
              <!-- No Data Row -->
              @if (filteredPolicies().length === 0) {
                <tr>
                  <td [attr.colspan]="18" class="text-center p-5 text-muted">
                    No policies found matching your search criteria.
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>

        <!-- Pagination - Custom Bootstrap Pagination -->
        <div class="card-footer bg-white d-flex flex-wrap align-items-center p-3">
          <!-- Pagination Info -->
          <div class="text-muted small mb-2 mb-md-0">
            {{ paginationInfo() }}
          </div>
            <div class="flex-grow-1"></div>
          <!-- Page Size Selector -->
          <div class="d-flex align-items-center gap-2 mb-2 mb-md-0 me-4">
             <label for="pageSize" class="form-label small text-nowrap mb-0">Rows:</label>
             <select id="pageSize" [value]="pageSize()" (change)="onPageSizeChange($event)" class="form-select form-select-sm" style="width: 75px;">
               <option value="5">5</option>
               <option value="10">10</option>
               <option value="25">25</option>
               <option value="50">50</option>
             </select>
          </div>

          <!-- Pagination Controls - UPDATED WITH SYMBOLS -->
          <nav aria-label="Policy pagination">
            <ul class="pagination pagination-sm mb-0">
              <li class="page-item" [class.disabled]="currentPage() === 1">
                <button class="page-link" (click)="goToPage(1)" aria-label="First">&laquo;</button>
              </li>
              <li class="page-item" [class.disabled]="currentPage() === 1">
                <button class="page-link" (click)="prevPage()" aria-label="Previous">&lsaquo;</button>
              </li>
              <li class="page-item" [class.disabled]="currentPage() === totalPages()">
                <button class="page-link" (click)="nextPage()" aria-label="Next">&rsaquo;</button>
              </li>
              <li class="page-item" [class.disabled]="currentPage() === totalPages()">
                <button class="page-link" (click)="goToPage(totalPages())" aria-label="Last">&raquo;</button>
              </li>
            </ul>
          </nav>
        </div>
      </div>
