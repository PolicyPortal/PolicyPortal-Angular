@if(isPageReady)
{
<div class="container-fluid">
     <!-- @if(!selectedDealer){ -->

     <div>
          <div class="d-flex justify-content-between align-items-center mb-3">
               <h3 class="Dealer-header">Dealer Management</h3>
               
               <button class="btn btn-primary" (click)="onAddNewDealer()">
                    <i class="bi bi-plus-circle me-2"></i>Add New Dealer
               </button>
          </div>

          <div class="card">
                 <div class="table-scroll-container">
                    <table class="requests-table">
                         <thead>
                              <tr>
                                   <th>ID</th>
                                   <th>Name</th>
                                   <th>Role</th>
                                   <th>Email</th>
                                   <!-- <th>Password</th> -->
                                   <th>Phone</th>
                                   <th>Status</th>
                                   <th>Actions</th>
                              </tr>
                         </thead>
                         <tbody>
                              <tr *ngFor="let dealer of dealers">
                                   <td>{{ dealer.user_id }}</td>
                                   <td>{{ dealer.name }}</td>
                                   <td>{{ dealer.role }}</td>
                                   <td>{{ dealer.email }}</td>
                                   <!-- <td>{{ dealer.password }}</td> -->
                                   <td>{{ dealer.phone }}</td>
                                   <td>
                                        <span class="badge"
                                             [ngClass]="dealer.status === 'Active' ? 'bg-success' : 'bg-secondary'">
                                             {{ dealer.status }}
                                        </span>
                                   </td>
                                   <td>
                                        <button class="btn btn-sm btn-outline-primary me-2" (click)="onEdit(dealer)"
                                             title="Edit">
                                             <i class="bi bi-pencil-square"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-danger"
                                             (click)="onDelete(dealer.user_id)" title="Delete">
                                             <i class="bi bi-trash"></i>
                                        </button>
                                   </td>
                              </tr>
                              <!-- <tr *ngIf="!dealers || dealers.length === 0">
                                   <td colspan="7" class="text-center">No dealers found.</td>
                              </tr> -->
                              <tr *ngIf="!dealers || dealers.length === 0" style="height: 100px;">
                                   <td colspan="7" class="text-center">
                                        <div class="spinner-border text-primary" role="status">
                                             <span class="visually-hidden">Loading...</span>
                                        </div>
                                   </td>
                         </tbody>
                    </table>
               </div>
          </div>
     </div>
     <!-- } -->
     @if(selectedDealer)
     {
     <div [class.hidden]="selectedDealer" class="modal-overlay" style="justify-content: center;">

          <div class="modal1">
               <div class="">
               <div class="modal-header">
                    <h3 class="modal-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                         <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                    </svg>
                    {{ isEditing ? 'Edit Dealer' : 'Add New Dealer' }}</h3>
                    <button class="modal-close" (click)="closeModal()">&times;</button>
               </div>

                    <div class="card-body">
                         <form (ngSubmit)="onSave()" #dealerForm="ngForm">
                              <div class="mb-3">
                                   <label for="name" class="form-label">Dealer Name</label>
                                   <input type="text" id="name" name="name" class="form-control"
                                        [(ngModel)]="selectedDealer.name" required>
                              </div>

                              <div class="row">
                                   <div class="col-md-6 mb-3">
                                        <label for="email" class="form-label">Email Address</label>
                                        <input type="email" id="email" name="email" class="form-control"
                                             [(ngModel)]="selectedDealer.email" required email [disabled]="isEditing">
                                   </div>
                                   <div class="col-md-6 mb-3" *ngIf="!isEditing">
                                        <label for="password" class="form-label">Password</label>
                                        <input type="password" id="password" name="password" class="form-control"
                                             [(ngModel)]="selectedDealer.password" required>
                                   </div>
                              </div>

                              <div class="row">
                                   <div class="col-md-6 mb-3">
                                        <label for="role" class="form-label">Role</label>
                                        <select id="role" name="role" class="form-select"
                                             [(ngModel)]="selectedDealer.role" required>
                                             <option value="" [disabled]="true" selected>Select Role</option>
                                             <option value="Admin">Admin</option>
                                             <option value="Dealer">Dealer</option>
                                        </select>
                                   </div>
                                   <div class="col-md-6 mb-3">
                                        <label for="phone" class="form-label">Phone Number</label>
                                        <input type="tel" id="phone" name="phone" class="form-control"
                                             [(ngModel)]="selectedDealer.phone" required>
                                   </div>
                              </div>




                              <div class="mb-3">
                                   <label for="location" class="form-label">Location</label>
                                   <textarea id="location" name="location" class="form-control"
                                        [(ngModel)]="selectedDealer.location" rows="3"></textarea>
                              </div>

                              <div class="mb-3">
                                   <label for="status" class="form-label">Status</label>
                                   <select id="status" name="status" class="form-select"
                                        [(ngModel)]="selectedDealer.status" required>
                                        <option value="Active">Active</option>
                                        <option value="Inactive">Inactive</option>
                                   </select>
                              </div>

                              <div class="d-flex justify-content-end">
                                   <!-- <button type="button" class="btn btn-secondary me-2"
                                        (click)="onCancel()">Cancel</button> -->
                                   <button type="submit" class="btn btn-primary" [disabled]="dealerForm.invalid">Save
                                        Dealer</button>
                              </div>
                         </form>
                    </div>
               </div>
          </div>
     </div>
}
</div>
}

@else
{
     <div class="d-flex justify-content-center align-items-center vh-100">
          <div class="spinner-border text-primary" role="status">
               <span class="visually-hidden">Loading...</span>
          </div>
     </div>
}
